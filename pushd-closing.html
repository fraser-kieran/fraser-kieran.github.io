<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Pushd Experiment</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <link rel="apple-touch-icon" href="images/favicon.png">
        <link rel="shortcut icon" href="images/favicon.png">
        
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
		<link rel="stylesheet" href="assets/css/pushd.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
        <style>
            .btn-likert.active {
                background-color: #079198!important;
            }
            p {
                margin-bottom: 10px;
            }
            h3 {
                margin-bottom: 5px;
            }
            .btn-group-sm.btn-group-toggle {
                margin-bottom: 20px;
            }
            input {
		      border: solid thin dimgray;
              margin-bottom: 20px;
            }
            textarea {
                margin-bottom: 20px;
            }
            input[type=number] {
                -webkit-appearance: none;
                border: solid thin dimgray;
            }
            ::-webkit-scrollbar {
                width: 0px;
                background: transparent; /* make scrollbar transparent */
            }
        </style>
        
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header" style="background-color: black">
				<div class="inner">
					<!--<a href="" class="image avatar"><img src="images/LinkedInProfiler.png" alt="" /></a>
					<h1><strong>Kieran Fraser</strong><br />
                        PhD Candidate @ ADAPT Centre<br/>
                        Trinity College Dublin</h1>-->
				</div>
			</header>

		<!-- Main -->
			<div id="main">
                    
				<!-- One -->
                    <span class="image"><img style="width: 50%; margin: auto;" src="images/pushd/pushd_black_no_caption_3.0.png" alt="pushd logo" /></span>
					<section id="one" style="text-align: center">
                        <br>
                        <div class="row" id="studyStats" style="display: none;">
                            <div class="col-md-4">
                                <p id="delivered" style="font-size: xx-large"></p>
                                <p># notifications delivered</p>
                            </div>
                            <div class="col-md-4">
                                <p id="answered" style="font-size: xx-large"></p>
                                <p># questionnaires answered</p>
                            </div>
                            <div class="col-md-4" id="daysLeftContainer">
                                <p id="daysLeft" style="font-size: xx-large"></p>
                                <p># days left before completion</p>
                            </div>
                        </div>
                        <br>
                        <div id="postQuestionnaire" style="display: none;">
                            <h3>Please answer the concluding questionnaire regarding your notification engagements. Thank you for your participation!
                            </h3>
                            <br>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <h3><strong>Top notification topics which you opened:</strong></h3>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-2">
                                    Data A:
                                </div>
                                <div class="col-md-4">
                                    <ol id="synthTopics">
                                    </ol>
                                </div>
                                <div class="col-md-2">
                                    Data B:
                                </div>
                                <div class="col-md-4">
                                    <ol id="realTopics">
                                    </ol>
                                </div>
                            </div>
                            <div class="row" style="text-align: center;">
                                <div class="col-md-12">
                                    <p>Which set of data, A or B, most accurately describes your notification engagements?</p>
                                    <select id="topics" class="selectpicker">
                                      <option value="" selected disabled>Nothing selected</option>
                                      <option>A</option>
                                      <option>B</option>
                                    </select>
                                </div>
                            </div>
                            <br>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <h3><strong>Top websites from notifications that you opened:</strong></h3>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-2">
                                    Data A:
                                </div>
                                <div class="col-md-4">
                                    <ol id="synthDomain">
                                    </ol>
                                </div>
                                <div class="col-md-2">
                                    Data B:
                                </div>
                                <div class="col-md-4">
                                    <ol id="realDomain">
                                    </ol>
                                </div>
                            </div>
                            <div class="row" style="text-align: center;">
                                <div class="col-md-12">
                                    <p>Which set of data, A or B, most accurately describes your notification engagements?</p>
                                    <select id="domains" class="selectpicker">
                                      <option value="" selected disabled>Nothing selected</option>
                                      <option>A</option>
                                      <option>B</option>
                                    </select>
                                </div>
                            </div>
                            <br>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <h3><strong>Top days you opened notifications:</strong></h3>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-2">
                                    Data A:
                                </div>
                                <div class="col-md-4">
                                    <ol id="synthDay">
                                    </ol>
                                </div>
                                <div class="col-md-2">
                                    Data B:
                                </div>
                                <div class="col-md-4">
                                    <ol id="realDay">
                                    </ol>
                                </div>
                            </div>
                            <div class="row" style="text-align: center;">
                                <div class="col-md-12">
                                    <p>Which set of data, A or B, most accurately describes your notification engagements?</p>
                                    <select id="days" class="selectpicker">
                                      <option value="" selected disabled>Nothing selected</option>
                                      <option>A</option>
                                      <option>B</option>
                                    </select>
                                </div>
                            </div>
                            <br>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <h3><strong>Top time (hour) of the day you opened notifications:</strong></h3>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-2">
                                    Data A:
                                </div>
                                <div class="col-md-4">
                                    <ol id="synthTime">
                                    </ol>
                                </div>
                                <div class="col-md-2">
                                    Data B:
                                </div>
                                <div class="col-md-4">
                                    <ol id="realTime">
                                    </ol>
                                </div>
                            </div>
                            <div class="row" style="text-align: center;">
                                <div class="col-md-12">
                                    <p>Which set of data, A or B, most accurately describes your notification engagements?</p>
                                    <select id="times" class="selectpicker">
                                      <option value="" selected disabled>Nothing selected</option>
                                      <option>A</option>
                                      <option>B</option>
                                    </select>
                                </div>
                            </div>
                            <br>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <h3><strong>Notification Presentation Format Unexpanded</strong></h3>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-2">
                                    Notification A:
                                </div>
                                <div class="col-md-4">
                                    <img src="images/pushd/control_closed.jpg" style="width: 100%;"/>
                                </div>
                                <div class="col-md-2">
                                    Notification B:
                                </div>
                                <div class="col-md-4">
                                    <img src="images/pushd/emp_closed.jpg"  style="width: 100%;"/>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <p>Which notification, A or B:</p>
                                    <ol>
                                        <li><p>is more informative <strong>at a glance</strong></p>
                                            <select id="formatInformative" class="selectpicker">
                                              <option value="" selected disabled>Nothing selected</option>
                                              <option>A</option>
                                              <option>B</option>
                                              <option>No difference</option>
                                            </select>
                                        </li>
                                        <li><p>would enable you to make a <strong>quicker</strong> decision (of opening or dismissing the notification)</p>
                                            <select id="formatDecision" class="selectpicker">
                                              <option value="" selected disabled>Nothing selected</option>
                                              <option>A</option>
                                              <option>B</option>
                                              <option>No difference</option>
                                            </select>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                            <br>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <h3><strong>Notification Presentation Format Expanded</strong></h3>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-2">
                                    Notification A:
                                </div>
                                <div class="col-md-4">
                                    <img src="images/pushd/control_open.jpg" style="width: 100%;"/>
                                </div>
                                <div class="col-md-2">
                                    Notification B:
                                </div>
                                <div class="col-md-4">
                                    <img src="images/pushd/emp_open.jpg"  style="width: 100%;"/>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <p>Which notification format, A or B:</p>
                                    <ol>
                                        <li><p>would better protect sensitive/private information, if present, in a notification?</p>
                                            <select id="formatPrivacy" class="selectpicker">
                                              <option value="" selected disabled>Nothing selected</option>
                                              <option>A</option>
                                              <option>B</option>
                                              <option>No difference</option>
                                            </select>
                                        </li>
                                        <li><p>would you prefer to be used by a machine making automated decisions on your behalf?</p>
                                            <select id="formatConsent" class="selectpicker">
                                              <option value="" selected disabled>Nothing selected</option>
                                              <option>A</option>
                                              <option>B</option>
                                              <option>Neither</option>
                                            </select>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                            <br>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <h3><strong>Emojis 😀</strong></h3>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-1">
                                    A:
                                </div>
                                <div class="col-md-3">
                                    <img src="images/pushd/control_open.jpg" style="width: 100%;"/>
                                </div>
                                <div class="col-md-1">
                                    B:
                                </div>
                                <div class="col-md-3">
                                    <img src="images/pushd/keywords.jpg"  style="width: 100%;"/>
                                </div>
                                <div class="col-md-1">
                                    C:
                                </div>
                                <div class="col-md-3">
                                    <img src="images/pushd/sentence.jpg"  style="width: 100%;"/>
                                </div>
                            </div>
                            <div class="row" style="text-align: left;">
                                <div class="col-md-12">
                                    <p>Which notification, A or B or C:</p>
                                    <ol>
                                        <li><p>is more visually enticing?</p>
                                            <select id="emojiEnticing" class="selectpicker">
                                              <option value="" selected disabled>Nothing selected</option>
                                              <option>A</option>
                                              <option>B</option>
                                              <option>C</option>
                                            </select>
                                        </li>
                                        <li><p>makes best use of emojis?</p>
                                            <select id="emojiUse" class="selectpicker">
                                              <option value="" selected disabled>Nothing selected</option>
                                              <option>A</option>
                                              <option>B</option>
                                              <option>C</option>
                                            </select>
                                        </li>
                                        <li><p>has the most relevant emojis for the content?</p>
                                            <select id="emojiRelevant" class="selectpicker">
                                              <option value="" selected disabled>Nothing selected</option>
                                              <option>A</option>
                                              <option>B</option>
                                              <option>C</option>
                                            </select>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                            <div id="emailDraw" class="row" style="text-align: left; display: none;">
                                <div class="col-md-12">
                                    <p>If you wish to be entered into the draw for a &#8364;100 One4All gift voucher, please enter your email below.<br><i>Note: emails will be used only to contact the winner and will not be used for any other purpose. Collected emails will be deleted once the draw has taken place</i></p>
                                    
                                    <input type="email" id="emailForDraw" name="email">
                                </div>
                            </div>
                            <br>
                            <button class="btn btn-success" id="completeButton" style="display: none;" onclick="goToProlific()">Confirm Completion</button>
                            <button class="btn btn-success" id="completeButtonAlt" style="display: none;" onclick="completed()">Confirm Completion</button>
                        </div>
                        <h5 id="notCompleteMessage" style="display: none;">A link to the Prolific Academic study submission confirmation page will appear here once you have completed the 21 days of the study, please check back again soon.</h5>
                        <h5 id="alreadyCompleteMessage" style="display: none;">You have confirmed completion.</h5>
                        <br>
					</section>
                
				<!-- Two -->
					
			</div>

		<!-- Footer -->
        <footer id="footer">
            <div class="inner">
                <ul class="copyright">
                    <li>Kieran Fraser @ ADAPT Centre</li><li>Trinity College Dublin</li>
                </ul>
            </div>
        </footer>
        
        
		<!-- Scripts -->
            <script
              src="https://code.jquery.com/jquery-3.4.1.min.js"
              integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
              crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
            
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
        
            <!-- The core Firebase JS SDK is always required and must be listed first -->
            <script src="https://www.gstatic.com/firebasejs/7.8.2/firebase-app.js"></script>
            <script src="https://www.gstatic.com/firebasejs/7.8.2/firebase-database.js"></script>
            <script src="https://www.gstatic.com/firebasejs/7.8.2/firebase-auth.js"></script>
        
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrender/1.0.4/jsrender.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>
        
            <script>
                
                // Your web app's Firebase configuration
                var firebaseConfig = {
                    apiKey: "AIzaSyAQu435FNTmXIcFigctYMdRO8sPLX78HI0",
                    authDomain: "pushdexp.firebaseapp.com",
                    databaseURL: "https://pushdexp.firebaseio.com",
                    projectId: "pushdexp",
                    storageBucket: "pushdexp.appspot.com",
                    messagingSenderId: "84430156157",
                    appId: "1:84430156157:web:b4fc89624448507bb05c14"
                };
                // Initialize Firebase
                firebase.initializeApp(firebaseConfig);
                var database = firebase.database();
                var prolificURL = null
                var userId = null
                var mySynth = null
                var myReal = null
                
                
                firebase.auth().onAuthStateChanged(function(user) {
                    if (user) {
                        var isAnonymous = user.isAnonymous;
                        var uid = user.uid;
                        getProlificURLS()
                        setUp()
                        
                    } else {
                        firebase.auth().signInAnonymously().catch(function(error) {
                            $.alert({
                                title: 'Oops!',
                                type: 'red',
                                content: 'Something went wrong. Please try again later.',
                            });
                            
                        });
                    }
                });
                
                function setUp(){
                    
                    var prolificId = ''
                    try{
                        const urlParams = new URLSearchParams(window.location.search);
                        prolificId = urlParams.get('PROLIFIC_PID');
                    }catch(e){}
                    if(prolificId && prolificId!=''){
                        try{
                            database.ref('participant').orderByChild('prolificId').equalTo(prolificId)
                            .once('value')
                            .then(function(snapshot) {
                                if(snapshot && snapshot.val()!=null){
                                    var user = null
                                    for(var key in snapshot.val()){
                                        if(key && key!=null)
                                            user = snapshot.val()[key]
                                        break
                                    }
                                    
                                    if(user && user!=null){
                                        var size = 0
                                        var answers = 0
                                        var daysLeft = 0
                                        var alreadyCompleted = false
                                        userId = user.id
                                        
                                        
                                        if(user.hasOwnProperty('notifications'))
                                            size = Object.keys(user.notifications).length
                                        if(user.hasOwnProperty('midstudy'))
                                            answers = Object.keys(user.midstudy).length
                                        if(user.hasOwnProperty('timeCompleted'))
                                            alreadyCompleted = true
                                        
                                        var timeDiff = (new Date()).getTime() - (new Date(user.signedUp)).getTime();
                                        var daysLeft = timeDiff / (1000 * 3600 * 24);
                                        daysLeft = 21 - Math.round(daysLeft)
                                        if(daysLeft < 0)
                                            daysLeft = 0
                                        var phase = user.phase
                                        
                                        $("#delivered").html(size);
                                        $("#answered").html(answers);
                                        $("#daysLeft").html(daysLeft);
                                        $('#studyStats').show()
                                        
                                        if(phase && phase==4 && !alreadyCompleted){
                                            $('#completeButton').show()
                                            getMetrics();
                                        } 
                                        else if (alreadyCompleted){
                                            $('#alreadyCompleteMessage').show()
                                        }
                                        else{
                                            $('#notCompleteMessage').show()
                                        }
                                        
                                    }
                                }
                            });
                        }catch(e){
                            $.alert({
                                title: 'Error!',
                                type: 'red',
                                content: 'There was an error submitting. Please contact the lead researcher.',
                            });
                            return
                        }
                    }
                    else{
                        // no prolific id.. get user id.. 
                        try{
                            // get userId from the p parameter!
                            const urlParams = new URLSearchParams(window.location.search);
                            userId = urlParams.get('u');
                            
                            database.ref('participant/'+userId)
                            .once('value')
                            .then(function(snapshot) {
                                if(snapshot && snapshot.val()!=null){
                                    var user = snapshot.val()
                                    
                                    var size = 0
                                    var answers = 0
                                    var daysLeft = 0
                                    var alreadyCompleted = false
                                    var prolificId = null

                                    if(user.hasOwnProperty('notifications'))
                                        size = Object.keys(user.notifications).length
                                    if(user.hasOwnProperty('midstudy'))
                                        answers = Object.keys(user.midstudy).length
                                    if(user.hasOwnProperty('timeCompleted'))
                                        alreadyCompleted = true
                                    try{
                                        if(user.hasOwnProperty('prolificId') && user.prolificId && user.prolificId!=null
                                          && user.prolificId!='')
                                            prolificId = user.prolificId
                                    }catch(e){}

                                    var phase = user.phase

                                    $("#delivered").html(size);
                                    $("#answered").html(answers);
                                        
                                    if(prolificId!=null){
                                        console.log(prolificId)
                                        var timeDiff = (new Date()).getTime() - (new Date(user.signedUp)).getTime();
                                        var daysLeft = timeDiff / (1000 * 3600 * 24);
                                        daysLeft = 21 - Math.round(daysLeft)
                                        if(daysLeft < 0)
                                            daysLeft = 0
                                        $("#daysLeft").html(daysLeft);
                                        $('#studyStats').show()
                                        
                                        if(phase && phase==4 && !alreadyCompleted){
                                            $('#completeButton').show()
                                            getMetrics();
                                        } 
                                        else if (alreadyCompleted){
                                            $('#alreadyCompleteMessage').show()
                                        }
                                        else{
                                            $('#notCompleteMessage').show()
                                        }
                                    }
                                    else{
                                        $("#daysLeftContainer").hide();
                                        $('#studyStats').show()
                                        $('#emailDraw').show()
                                        if(phase && phase==4 && !alreadyCompleted){
                                            $('#completeButtonAlt').show()
                                            getMetrics();
                                        }
                                        else if (alreadyCompleted){
                                            $('#alreadyCompleteMessage').show()
                                        }
                                    }
                                }
                                else{
                                    $.alert({
                                        title: 'Error!',
                                        type: 'red',
                                        content: 'There was an error. Please contact the lead researcher.',
                                    });
                                }
                            });
                            
                        } catch(e){
                            $.alert({
                                title: 'Error!',
                                type: 'red',
                                content: 'There was an error. Please contact the lead researcher.',
                            });
                        }
                    }
                    
                }
                
                
                // Get the notifications..
                // Top topics opened
                // Top domains opened
                // Hours most receptive
                // Days of week most receptive
                function getMetrics(){
                    if(userId && userId!=''){
                        var metricsUrl = "https://empushy.azurewebsites.net/v1/pushd/metrics";

                        var formData = JSON.stringify({
                            "text": userId
                        })

                        fetch(metricsUrl, {
                            method: 'post',
                            headers: {
                              "Content-type": "application/json; charset=utf-8"
                            },
                            body: formData
                        })
                        .then((response) => {
                            return response.json();
                        })
                        .then((data) => {
                            try{
                                myReal = data['result']['real'];
                                mySynth = data['result']['synth'];

                                for(var t of myReal[0])
                                    $('#realTopics').append('<li>'+t+'</li>')
                                for(var d of myReal[1])
                                    $('#realDomain').append('<li>'+d+'</li>')
                                for(var d of myReal[2])
                                    $('#realTime').append('<li>'+d+'</li>')
                                for(var t of myReal[3])
                                    $('#realDay').append('<li>'+t+'</li>')
                                
                                for(var t of mySynth[0])
                                    $('#synthTopics').append('<li>'+t+'</li>')
                                for(var d of mySynth[1])
                                    $('#synthDomain').append('<li>'+d+'</li>')
                                for(var d of mySynth[2])
                                    $('#synthTime').append('<li>'+d+'</li>')
                                for(var t of mySynth[3])
                                    $('#synthDay').append('<li>'+t+'</li>')
                                
                                $('#postQuestionnaire').show()
                            }catch(e){}
                        });
                    }
                }
                
                function goToProlific(){
                    
                    if(userId!=null && prolificURL!=null){
                        
                        
                        // get questionnaire results
                        topics = $('#topics').val()
                        domains = $('#domains').val()
                        days = $('#days').val()
                        times = $('#times').val()
                        formatInformative = $('#formatInformative').val()
                        formatDecision = $('#formatDecision').val()
                        formatPrivacy = $('#formatPrivacy').val()
                        formatConsent = $('#formatConsent').val()
                        emojiEnticing = $('#emojiEnticing').val()
                        emojiUse = $('#emojiUse').val()
                        emojiRelevant = $('#emojiRelevant').val()
                        
                        if(topics!=null && domains!=null && days!=null && 
                          times!=null && formatInformative!=null && formatDecision!=null && 
                          formatPrivacy!=null && formatConsent!=null && emojiEnticing!=null && emojiUse!=null &&
                          emojiRelevant!=null){
                            
                            postQuestionnaire = {
                                                    timeCompleted: Math.round((new Date()).getTime()), 
                                                    post_study: [topics, domains, days, times, formatInformative,
                                                               formatDecision, formatPrivacy, formatConsent, emojiEnticing, 
                                                               emojiUse, emojiRelevant]
                                                }
                            
                            database.ref('participant/'+userId).update(postQuestionnaire, function(error) {
                                if (error) {
                                    $.alert({
                                        title: 'Error!',
                                        type: 'red',
                                        content: 'There was an error submitting. Please contact the lead researcher.',
                                    });
                                    return
                                } else {
                                    window.location.replace(prolificURL);
                                }
                            })
                        }
                        else{
                            $.alert({
                                title: 'Wait!',
                                type: 'orange',
                                content: 'You must complete all questionnaire fields to continue..',
                            });
                            return
                        }
                        
                    }
                    else{
                        $.alert({
                            title: 'Error!',
                            type: 'red',
                            content: 'There was an error submitting. Please contact the lead researcher.',
                        });
                        return
                    }
                }
                
                function getProlificURLS(){
                    var pushRef = database.ref('prolific_urls/end')
                    .once('value')
                    .then(function(snapshot) {
                        if(snapshot && snapshot.val()!=null){
                            prolificURL = snapshot.val()
                        }
                    });
                }
                            
                function completed(){
                    if(userId!=null){
                        
                        // get questionnaire results
                        topics = $('#topics').val()
                        domains = $('#domains').val()
                        days = $('#days').val()
                        times = $('#times').val()
                        emailForDraw = $('#emailForDraw').val()
                        formatInformative = $('#formatInformative').val()
                        formatDecision = $('#formatDecision').val()
                        formatPrivacy = $('#formatPrivacy').val()
                        formatConsent = $('#formatConsent').val()
                        emojiEnticing = $('#emojiEnticing').val()
                        emojiUse = $('#emojiUse').val()
                        emojiRelevant = $('#emojiRelevant').val()
                        
                        if(topics!=null && domains!=null && days!=null && 
                          times!=null && formatInformative!=null && formatDecision!=null && 
                          formatPrivacy!=null && formatConsent!=null && emojiEnticing!=null && emojiUse!=null &&
                          emojiRelevant!=null){
                            
                            postQuestionnaire = {
                                                    timeCompleted: Math.round((new Date()).getTime()), 
                                                    post_study: [topics, domains, days, times, formatInformative,
                                                               formatDecision, formatPrivacy, formatConsent, emojiEnticing, 
                                                               emojiUse, emojiRelevant],
                                                    emailForDraw: emailForDraw
                                                }
                            database.ref('participant/'+userId).update(postQuestionnaire, function(error) {
                                if (error) {
                                    $.alert({
                                        title: 'Error!',
                                        type: 'red',
                                        content: 'There was an error submitting. Please contact the lead researcher.',
                                    });
                                    return
                                } else {
                                    $.alert({
                                        title: 'Thank you!',
                                        type: 'green',
                                        content: 'Study completed. Your contribution is greatly appreciated.',
                                    });
                                    $('#completeButtonAlt').prop('disabled', true)
                                }
                            })
                            
                        }
                        else{
                            $.alert({
                                title: 'Wait!',
                                type: 'orange',
                                content: 'You must complete all questionnaire fields to continue..',
                            });
                            return
                        }
                        
                    }
                    else{
                        $.alert({
                            title: 'Error!',
                            type: 'red',
                            content: 'There was an error submitting. Please contact the lead researcher.',
                        });
                        return
                    }
                }
                
            </script>
            
			<script src="assets/js/jquery.poptrox.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
           

	</body>
</html>