<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Pushd Experiment</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <link rel="apple-touch-icon" href="images/favicon.png">
        <link rel="shortcut icon" href="images/favicon.png">
        
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
		<link rel="stylesheet" href="assets/css/pushd.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
        
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header" style="background-color: black">
				<div class="inner">
					<!--<a href="" class="image avatar"><img src="images/LinkedInProfiler.png" alt="" /></a>
					<h1><strong>Kieran Fraser</strong><br />
                        PhD Candidate @ ADAPT Centre<br/>
                        Trinity College Dublin</h1>-->
				</div>
			</header>

		<!-- Main -->
			<div id="main">
                    
				<!-- One -->
                    <span class="image"><img style="width: 50%; margin: auto;" src="images/pushd/pushd_black_no_caption_3.0.png" alt="pushd logo" /></span>
					<section id="one">
                        <p>The <strong>Pushd</strong> experiment aims to test alternate methods of creating and delivering push-notifications in order to improve the engagement experience for notification receivers. This is achieved by monitoring engagements with notifications and identifying patterns of preference for content and delivery. 
                        </p>
                        <p>For this experiment, you are asked to answer a number of questions relating to your push-notification preferences before then subscribing to a number of topics. You will then be pushed notifications relating to those topics over a period of two weeks with your subsequent engagements (open/dismiss) recorded. At the end of the two week period you will be asked to answer a final questionnaire.</p>
                        
                        <p>You may opt out of the experiment at any time within the two week period by returning to this page and selecting <i>unsubscribe</i>. This will destroy all data collected.</p>
						
                        <p>Please read the following documents before signing up:</p>
                        <ol>
                            <li><a href="" target="_blank">Participant Information Sheet</a></li>
                            <li><a href="" target="_blank">Informed Consent</a></li>
                        </ol>   
                        <div>
                            <input type="checkbox" id="cb-info" name="cb-info">
				            <label for="cb-info">I have read and understood the Participant Information Sheet.</label>
                            
                            <input type="checkbox" id="cb-consent" name="cb-consent">
				            <label for="cb-consent">I have read the Informed Consent document and am happy to grant my consent.</label>
                        </div>
                        <p id="checkbox-message" style="display: none;"><strong style="color: red;">You must check all boxes to participate in the project.</strong></p>
						<ul class="actions">
							<li><a id="subButton" class="button" onclick="signup()">Lets Start</a></li>
						</ul>
                        <p id="success-message" style="display: none;"><strong style="color: green;">Thank you for signing up! Please now download the app and sign-in using the same credentials.</strong></p>
                        <div id="sign-up-container" style="display: none;">
                            <p>Enter your Prolific Academic email address below and select next.</p>
                            <div id="firebaseui-auth-container"></div>
                        </div>
					</section>
                
				<!-- Two -->
					<section id="four">
                        <div class="container-fluid">
                            <h2>Get In Touch</h2>
                            <p>If you have any questions regarding the <strong>Pushd</strong> Experiment, please use the form below or the email address provided and I will follow up ASAP!</p>
                            <div class="row">
                                <div class="col-md-8">
                                    <form id='contact' action="https://formspree.io/kieran.fraser@adaptcentre.ie" method="POST">
                                        <div class="row gtr-uniform gtr-50">
                                            <div class="col-6 col-12-xsmall"><input type="text" name="name" id="name" placeholder="Name" /></div>
                                            <div class="col-6 col-12-xsmall"><input type="email" name="email" id="email" placeholder="Email" /></div>
                                            <div class="col-12"><textarea name="message" id="message" placeholder="Message" rows="4"></textarea></div>
                                        </div>
                                        <br/>
                                        <ul class="actions">
                                            <li><input type="submit" value="Send Message" /></li>
                                        </ul>
                                    </form>
                                </div>
                                <div class="col-md-4">
                                    <ul class="labeled-icons">
                                        <li>
                                            <h3 class="icon fa-home"><span class="label">Location</span></h3>
                                            Dublin, Ireland<br />
                                        </li>
                                        <li>
                                            <h3 class="icon fa-envelope-o"><span class="label">Email</span></h3>
                                            <a href="#">kieran.fraser@adaptcentre.ie</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
					</section>
			</div>

		<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					<ul class="copyright">
						<li>Kieran Fraser @ ADAPT Centre</li><li>Trinity College Dublin</li>
					</ul>
				</div>
			</footer>
        

        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h2 id="exampleModalLabel">Pre-Study Questionnaire <i>(max 5 mins)</i></h2>
              </div>
              <div class="modal-body" style="overflow-y: scroll;">
                <ol>
                    <li>Select applicable gender:<br>
                        <select class="selectpicker">
                          <option>Nothing </option>
                          <option>Male</option>
                          <option>Female</option>
                          <option>Other</option>
                        </select>

                    </li>
                    <li>Select applicable age group:<br>
                        <select class="selectpicker">
                          <option>Male</option>
                          <option>18-29</option>
                          <option>30-39</option>
                          <option>40-49</option>
                          <option>50-59</option>
                          <option>60+</option>
                        </select>

                    </li>
                    <li>Select multiple (min 5) topics which you would like to receive notifications on:<br>
                        <select id="topicPrefs" class="selectpicker" multiple>
                            <option>arts</option>
                            <option>business</option>
                            <option>college</option>
                            <option>comedy</option>
                            <option>crime</option>
                            <option>divorce</option>
                            <option>education</option>
                            <option>entertainment</option>
                            <option>environment</option>
                            <option>food &amp; drink</option>
                            <option>good news</option>
                            <option>green</option>
                            <option>healthy living</option>
                            <option>home &amp; living</option>
                            <option>impact</option>
                            <option>media</option>
                            <option>money</option>
                            <option>parenting</option>
                            <option>politics</option>
                            <option>science</option>
                            <option>sports</option>
                            <option>style</option>
                            <option>taste</option>
                            <option>tech</option>
                            <option>travel</option>
                            <option>weddings</option>
                            <option>wellness</option>
                            <option>world news</option>
                            <option>worldpost</option>
                        </select>
                    </li>
                    <li>Select multiple websites which you would like to receive notifications from:<br>
                        <select id="posWebPrefs" class="selectpicker" data-max-options="15" multiple onchange="generateTestNotifications()">
                            <optgroup label="arts">
                            <option>imdb.com</option>
                            <option>cnn.com</option>
                            <option>bbc.co.uk</option>
                            <option>livejournal.com</option>
                            <option>pandora.com</option>
                            <option>rottentomatoes.com</option>
                            <option>foodnetwork.co.uk</option>
                            <option>history.com</option>
                            <option>wired.com</option>
                            <option>variety.com</option>
                            <optgroup label="business">
                            <option>forbes.com</option>
                            <option>bloomberg.com</option>
                            <option>reuters.com</option>
                            <option>springer.com</option>
                            <option>fidelity.com</option>
                            <option>investopedia.com</option>
                            <option>businessinsider.com</option>
                            <option>indeed.com</option>
                            <option>alibaba.com</option>
                            <option>finance.yahoo.com</option>
                            <optgroup label="health">
                            <option>psychologytoday.com</option>
                            <option>weightwatchers.com</option>
                            <option>menshealth.com</option>
                            <option>verywellmind.com</option>
                            <option>kidshealth.org</option>
                            <option>verywellfit.com</option>
                            <option>health.com</option>
                            <option>self.com</option>
                            <option>vitals.com</option>
                            <option>tonyrobbins.com</option>
                            <optgroup label="news">
                            <option>reddit.com</option>
                            <option>nytimes.com</option>
                            <option>time.com</option>
                            <option>euronews.com</option>
                            <option>news.google.com</option>
                            <option>theguardian.com</option>
                            <option>thejournal.ie</option>
                            <option>irishtimes.com</option>
                            <option>rte.ie</option>
                            <option>independent.ie</option>
                            <optgroup label="sports">
                            <option>goal.com</option>
                            <option>premierleague.com</option>
                            <option>skysports.com</option>
                            <option>foxsports.com</option>
                            <option>eurosport.co.uk</option>
                            <option>sportingnews.com</option>
                            <option>runnersworld.com</option>
                            <option>pinkbike.com</option>
                            <option>sports.yahoo.com</option>
                            <option>cricbuzz.com</option>
                            <optgroup label="science">
                            <option>researchgate.net</option>
                            <option>sciencedirect.com</option>
                            <option>elsevier.com</option>
                            <option>ted.com</option>
                            <option>nature.com</option>
                            <option>livescience.com</option>
                            <option>arxiv.org</option>
                            <option>sciencedaily.com</option>
                            <option>space.com</option>
                            <option>economist.com</option>
                            <optgroup label="recreation">
                            <option>booking.com</option>
                            <option>tripadvisor.com</option>
                            <option>9gag.com</option>
                            <option>hotels.com</option>
                            <option>kayak.com</option>
                            <option>ryanair.com</option>
                            <option>skyscanner.com</option>
                            <option>lego.com</option>
                            <option>couchsurfing.com</option>
                            <option>trivago.com</option>
                            <optgroup label="games">
                            <option>gamespot.com</option>
                            <option>epicgames.com</option>
                            <option>ea.com</option>
                            <option>blizzard.com</option>
                            <option>pcgamer.com</option>
                            <option>itch.io</option>
                            <option>betfair.com</option>
                            <option>store.steampowered.com</option>
                            <option>nvidia.com</option>
                            <optgroup label="reference">
                            <option>stackoverflow.com</option>
                            <option>udemy.com</option>
                            <option>archive.org</option>
                            <option>investopedia.com</option>
                            <option>howstuffworks.com</option>
                            <option>answers.com</option>
                            <option>brainyquote.com</option>
                            <option>goodreads.com</option>
                            <option>collegeboard.org</option>
                            <option>coursera.org</option>
                            <optgroup label="shopping">
                            <option>amazon.com</option>
                            <option>ebay.com</option>
                            <option>etsy.com</option>
                            <option>bestbuy.com</option>
                            <option>homedepot.com</option>
                            <option>ticketmaster.com</option>
                            <option>groupon.com</option>
                            <option>gap.com</option>
                            <option>bedbathandbeyond.com</option>
                            <option>ikea.com</option>
                        </select>
                    </li>
                    <li>Select multiple websites which you would <strong>NOT</strong> like to receive notifications from:<br>
                        <select id="negWebPrefs" class="selectpicker" data-max-options="15" multiple onchange="generateTestNotifications()">
                            <optgroup label="arts">
                            <option>imdb.com</option>
                            <option>cnn.com</option>
                            <option>bbc.co.uk</option>
                            <option>livejournal.com</option>
                            <option>pandora.com</option>
                            <option>rottentomatoes.com</option>
                            <option>foodnetwork.co.uk</option>
                            <option>history.com</option>
                            <option>wired.com</option>
                            <option>variety.com</option>
                            <optgroup label="business">
                            <option>forbes.com</option>
                            <option>bloomberg.com</option>
                            <option>reuters.com</option>
                            <option>springer.com</option>
                            <option>fidelity.com</option>
                            <option>investopedia.com</option>
                            <option>businessinsider.com</option>
                            <option>indeed.com</option>
                            <option>alibaba.com</option>
                            <option>finance.yahoo.com</option>
                            <optgroup label="health">
                            <option>psychologytoday.com</option>
                            <option>weightwatchers.com</option>
                            <option>menshealth.com</option>
                            <option>verywellmind.com</option>
                            <option>kidshealth.org</option>
                            <option>verywellfit.com</option>
                            <option>health.com</option>
                            <option>self.com</option>
                            <option>vitals.com</option>
                            <option>tonyrobbins.com</option>
                            <optgroup label="news">
                            <option>reddit.com</option>
                            <option>nytimes.com</option>
                            <option>time.com</option>
                            <option>euronews.com</option>
                            <option>news.google.com</option>
                            <option>theguardian.com</option>
                            <option>thejournal.ie</option>
                            <option>irishtimes.com</option>
                            <option>rte.ie</option>
                            <option>independent.ie</option>
                            <optgroup label="sports">
                            <option>goal.com</option>
                            <option>premierleague.com</option>
                            <option>skysports.com</option>
                            <option>foxsports.com</option>
                            <option>eurosport.co.uk</option>
                            <option>sportingnews.com</option>
                            <option>runnersworld.com</option>
                            <option>pinkbike.com</option>
                            <option>sports.yahoo.com</option>
                            <option>cricbuzz.com</option>
                            <optgroup label="science">
                            <option>researchgate.net</option>
                            <option>sciencedirect.com</option>
                            <option>elsevier.com</option>
                            <option>ted.com</option>
                            <option>nature.com</option>
                            <option>livescience.com</option>
                            <option>arxiv.org</option>
                            <option>sciencedaily.com</option>
                            <option>space.com</option>
                            <option>economist.com</option>
                            <optgroup label="recreation">
                            <option>booking.com</option>
                            <option>tripadvisor.com</option>
                            <option>9gag.com</option>
                            <option>hotels.com</option>
                            <option>kayak.com</option>
                            <option>ryanair.com</option>
                            <option>skyscanner.com</option>
                            <option>lego.com</option>
                            <option>couchsurfing.com</option>
                            <option>trivago.com</option>
                            <optgroup label="games">
                            <option>gamespot.com</option>
                            <option>epicgames.com</option>
                            <option>ea.com</option>
                            <option>blizzard.com</option>
                            <option>pcgamer.com</option>
                            <option>itch.io</option>
                            <option>betfair.com</option>
                            <option>store.steampowered.com</option>
                            <option>nvidia.com</option>
                            <optgroup label="reference">
                            <option>stackoverflow.com</option>
                            <option>udemy.com</option>
                            <option>archive.org</option>
                            <option>investopedia.com</option>
                            <option>howstuffworks.com</option>
                            <option>answers.com</option>
                            <option>brainyquote.com</option>
                            <option>goodreads.com</option>
                            <option>collegeboard.org</option>
                            <option>coursera.org</option>
                            <optgroup label="shopping">
                            <option>amazon.com</option>
                            <option>ebay.com</option>
                            <option>etsy.com</option>
                            <option>bestbuy.com</option>
                            <option>homedepot.com</option>
                            <option>ticketmaster.com</option>
                            <option>groupon.com</option>
                            <option>gap.com</option>
                            <option>bedbathandbeyond.com</option>
                            <option>ikea.com</option>
                        </select>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-primary" onclick="mindfulModal()">Mindful Scale</button>
                    </li>
                    <br>
                    <li>
                        <button class="btn btn-primary" onclick="curiosityModal()">Curiosity Inventory</button>
                    </li>
                </ol>
                <p id="feedInstructions" style="display: none;">The following 15 notifications have been autonomously generated from your selected websites. Please select the actions (open or dismiss) which you might take on these notifications:</p>
                <div id="notificationFeed"></div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-danger" onclick="cancelParticipation()">Cancel Participation</button>
                <button type="button" class="btn btn-success" onclick="savePrefs()">Proceed</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Modal -->
        <div class="modal fade" id="mindfulModal" tabindex="-1" role="dialog" aria-labelledby="mindfulModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h2 id="mindfulModalLabel">Mindful Attention Awareness Scale</h2>
              </div>
              <div class="modal-body" style="overflow-y: scroll;">
                    <label class="statement">I could be experiencing some emotion and not be conscious of
it until some time later.</label>
                    <label class="radio-inline"><input type="radio" name="optradio" checked>strongly agree</label>
                    <label class="radio-inline"><input type="radio" name="optradio">agree</label>
                    <label class="radio-inline"><input type="radio" name="optradio">neutral</label>
                    <label class="radio-inline"><input type="radio" name="optradio">disagree</label>
                    <label class="radio-inline"><input type="radio" name="optradio">strongly disagree</label>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-danger" onclick="closeMindfulModal()">Cancel</button>
                <button type="button" class="btn btn-success" onclick="saveMindful()">Save</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Modal -->
        <div class="modal fade" id="curiosityModal" tabindex="-1" role="dialog" aria-labelledby="curiosityModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h2 id="curiosityModalLabel">Curiosity and Exploration Inventory (CEI-II)</h2>
              </div>
              <div class="modal-body" style="overflow-y: scroll;">
                <p><strong>Instructions: </strong>Rate the statements below for how accurately they reflect the way you
generally feel and behave. Do not rate what you think you should do, or wish you do, or
things you no longer do. Please be as honest as possible.</p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-danger" onclick="closeCuriosityModal()">Cancel</button>
                <button type="button" class="btn btn-success" onclick="saveCuriosity()">Save</button>
              </div>
            </div>
          </div>
        </div>
        
		<!-- Scripts -->
            <script
              src="https://code.jquery.com/jquery-3.4.1.min.js"
              integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
              crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
            <!-- Latest compiled and minified JavaScript -->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>
            
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
        
            <!-- The core Firebase JS SDK is always required and must be listed first -->
            <script src="https://www.gstatic.com/firebasejs/7.8.2/firebase-app.js"></script>
            <script src="https://www.gstatic.com/firebasejs/7.8.2/firebase-database.js"></script>
            <script src="https://www.gstatic.com/firebasejs/7.8.2/firebase-auth.js"></script>
            <script src="assets/js/web-push-initialise.js"></script>
        
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrender/1.0.4/jsrender.min.js"></script>
        
            <script>
                
                var notificationString = '<div class="card" style="width: 100%; margin-bottom: 10px">'+
                      '<div class="card-body" style="padding: 10px;">'+
                        '<div class="container-fluid" style="width: 100%; margin: 0px; padding: 0px;">'+
                            '<div class="row">'+
                                '<div class="col-md-2">'+
                                    '<img src="https://{{:domain}}/favicon.ico" alt=" " style="height: 35px; padding: 5px; border-radius: 50%; border-radius: 50%;border: solid;border-width: thin;    border-color: black;">'+
                                '</div>'+
                                '<div class="col-md-10">'+
                                    '<h5 class="card-title" style="padding: 10px;">{{:title}}</h5>'+
                                '</div>'  +
                            '</div>'+
                        '</div>'  +
                        /*'<p class="card-text">{{:ticker}}</p>'+*/
                        '<div style="text-align: center; margin: 0px; padding: 0px;">'+
                            '<div class="btn-group btn-group-toggle" data-toggle="buttons">'+
                              '<label class="btn btn-secondary" name="open" id="{{:id}}">'+
                                '<input type="radio" autocomplete="off">Open'+
                              '</label>'+
                              '<label class="btn btn-secondary" name="dismiss" id="{{:id}}">'+
                                '<input type="radio" autocomplete="off">Dismiss'+
                              '</label>'+
                            '</div>'+
                        '</div>'+
                        '<p style="text-align: right; font-size: small; margin: 0px;">{{:domain}}</p>'+
                      '</div>'+
                    '</div>'
                var notificationTemplate = $.templates(notificationString);
                
                // Your web app's Firebase configuration
                var firebaseConfig = {
                    apiKey: "AIzaSyAQu435FNTmXIcFigctYMdRO8sPLX78HI0",
                    authDomain: "pushdexp.firebaseapp.com",
                    databaseURL: "https://pushdexp.firebaseio.com",
                    projectId: "pushdexp",
                    storageBucket: "pushdexp.appspot.com",
                    messagingSenderId: "84430156157",
                    appId: "1:84430156157:web:b4fc89624448507bb05c14"
                };
                // Initialize Firebase
                firebase.initializeApp(firebaseConfig);
                var database = firebase.database();
                
                var notificationList = []
                
                $('#exampleModal').modal({
                    backdrop: 'static',
                    keyboard: false
                })
                
                initSubscribe()
                
                firebase.auth().onAuthStateChanged(function(user) {
                    if (user) {
                        var isAnonymous = user.isAnonymous;
                        var uid = user.uid;
                        getAllNotifications()
                    } else {
                        firebase.auth().signInAnonymously().catch(function(error) {
                            $.alert({
                                title: 'Oops!',
                                type: 'red',
                                content: 'Something went wrong. Please try again later.',
                            });
                            
                        });
                    }
                });
                
                function mindfulModal(){
                    $('#mindfulModal').modal({
                        backdrop: 'static',
                        keyboard: false
                    })
                } 
                
                function closeMindfulModal(){
                    $('#mindfulModal').modal('hide')
                }
                
                function curiosityModal(){
                    $('#curiosityModal').modal({
                        backdrop: 'static',
                        keyboard: false
                    })
                }
                
                function closeCuriosityModal(){
                    $('#curiosityModal').modal('hide')
                }
                
                function signup(){
                    if($("#cb-info").prop('checked') && $("#cb-consent").prop('checked')){
                        $("#checkbox-message").hide();
                        subButtonClick()
                    }
                    else{
                        $("#checkbox-message").show();
                    }
                }
                
                function savePrefs(){
                    
                    topics = $('#topicPrefs').val()
                    posWeb = $('#posWebPrefs').val()
                    negWeb = $('#negWebPrefs').val()
                    
                    opened = []
                    dismissed = []
                    
                    $("#notificationFeed .active").each(function() {
                        var name = $(this).attr('name');
                        var id = $(this).attr('id');
                        if(name=='open')
                            opened.push(id)
                        else
                            dismissed.push(id)
                   });
                    
                    if(topics.length<2|posWeb.length<2|negWeb.length<2|(opened.length+dismissed.length)<5){
                        $.alert({
                            title: 'Wait!',
                            type: 'orange',
                            content: 'You must select at least 2 topics<br><strong>and</strong> at least 4 websites (2 positive and 2 negative)<br><strong>and</strong> open or dismiss at least 5 generated notifications...',
                        });
                        return
                    }
                    else{
                        savePreferences(topics, posWeb, negWeb, opened, dismissed)
                        
                        $.confirm({
                            title: 'Finished',
                            type: 'green',
                            content: 'You are now set up. Simply engage with incoming notifiations as normal over the next two weeks. You will receive a final questionnaire via notification at the end of the experiment period which will conclude the study. Thanks for participating!',
                            buttons: {
                                confirm: function () {
                                    $('#exampleModal').modal('hide')
                                }
                            }
                        });
                    }
                }
                
                function savePreferences(topics, posWeb, negWeb, opened, dismissed) {
                    
                    
                    userId = document.cookie.split('=')[1]
                    if(userId.charAt(0) == '-'){
                        database.ref('participant/'+userId).update({
                            topics: topics,
                            pos_web: posWeb,
                            neg_web: negWeb,
                            init_open: opened,
                            init_dismissed: dismissed
                        });
                    }
                }
                
                function generateTestNotifications(){
                    posWeb = $('#posWebPrefs').val()
                    negWeb = $('#negWebPrefs').val()
                    
                    notifications = []
                    websites = posWeb.concat(negWeb)
                    for(notification of notificationList){
                        if(websites.some(website => notification.domain.includes(website)))
                            notifications.push({title: notification.summary, ticker: notification.summary,
                                              id: notification.id, domain: notification.domain})
                    }
                    
                    var html = notificationTemplate.render(getRandom(notifications, notifications.length<=10?notifications.length : 10));
                    $( "#notificationFeed" ).empty()
                    $( "#feedInstructions" ).show()
                    $( "#notificationFeed" ).append(html)
                    
                }
                
                function getRandom(arr, n) {
                    var result = new Array(n),
                        len = arr.length,
                        taken = new Array(len);
                    if (n > len)
                        throw new RangeError("getRandom: more elements taken than available");
                    while (n--) {
                        var x = Math.floor(Math.random() * len);
                        result[n] = arr[x in taken ? taken[x] : x];
                        taken[x] = --len in taken ? taken[len] : len;
                    }
                    return result;
                }
                
                function getAllNotifications(){
                    var pushRef = database.ref('notifications/')
                    .once('value')
                    .then(function(snapshot) {
                        
                        notificationList = []
                        if(snapshot.val()!=null){
                            snapshot.forEach((notification)=> {
                                notificationList.push(notification.val())
                            });
                        }
                    });
                }
                
                function cancelParticipation(){
                    subButtonClick()
                }
            </script>
            
			<script src="assets/js/jquery.poptrox.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
           

	</body>
</html>